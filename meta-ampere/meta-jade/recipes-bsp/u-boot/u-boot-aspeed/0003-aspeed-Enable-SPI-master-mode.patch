From de417519685507c3c4372edea15d6ee7ef7e1e8a Mon Sep 17 00:00:00 2001
From: Chanh Nguyen <chanh@os.amperecomputing.com>
Date: Tue, 1 Jun 2021 05:48:14 +0000
Subject: [PATCH 3/3] aspeed: Enable SPI master mode

Currently, some systems design the strap pin,
which was shared pin with another function.
That makes the board strapping does not reflect the intended use of the system.

This patch will enable SPI master mode by default.

Signed-off-by: Chanh Nguyen <chanh@os.amperecomputing.com>
---
 board/aspeed/ast-g5/ast-g5.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/board/aspeed/ast-g5/ast-g5.c b/board/aspeed/ast-g5/ast-g5.c
index 19f2a54fec..ecc25d9346 100644
--- a/board/aspeed/ast-g5/ast-g5.c
+++ b/board/aspeed/ast-g5/ast-g5.c
@@ -113,6 +113,9 @@ int board_late_init(void)
 		update_bootargs_cmd("resetreason", value);
 	}
 
+	/* enable SPI master */
+	ast_scu_spi_master(1);
+
 	return 0;
 }
 #endif
-- 
2.25.1

