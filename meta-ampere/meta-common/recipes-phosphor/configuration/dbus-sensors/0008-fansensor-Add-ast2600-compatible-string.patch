From 17d69a6f4ac293e4a6f60f5c4b121a11f516ae7b Mon Sep 17 00:00:00 2001
From: Chau Ly <chaul@amperecomputing.com>
Date: Fri, 12 May 2023 08:06:34 +0000
Subject: [PATCH] meta-ampere: fansensor: Add ast2600 compatible string

Fan in Aspeed2600 has not been supported upstream but in Aspeed-SDK
only. The new method in dbus-sensors fansensor for getting fan type of a
hwmon path from compatible string does not include the ast2600-tach
string. This commit adds the string to the compatibleFanTypes list to
make the fans in mitchell search-able by the application.

Tested:
$ busctl tree xyz.openbmc_project.FanSensor
fan sensors are created successfully

Signed-off-by: Chau Ly <chaul@amperecomputing.com>
---
 src/FanMain.cpp | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/FanMain.cpp b/src/FanMain.cpp
index 85de747..8422dc1 100644
--- a/src/FanMain.cpp
+++ b/src/FanMain.cpp
@@ -66,6 +66,7 @@ std::optional<RedundancySensor> systemRedundancy;
 static const std::map<std::string, FanTypes> compatibleFanTypes = {
     {"aspeed,ast2400-pwm-tacho", FanTypes::aspeed},
     {"aspeed,ast2500-pwm-tacho", FanTypes::aspeed},
+    {"aspeed,ast2600-tach", FanTypes::aspeed},
     {"nuvoton,npcm750-pwm-fan", FanTypes::nuvoton},
     {"hpe,gxp-fan-ctrl", FanTypes::hpe}
     // add compatible string here for new fan type
-- 
2.25.1

