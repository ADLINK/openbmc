From 65eccc58a26e51225427e04deec0735bdca536ba Mon Sep 17 00:00:00 2001
From: Chau Ly <chaul@amperecomputing.com>
Date: Tue, 16 May 2023 10:29:25 +0700
Subject: [PATCH 6/7] meta-ampere: fansensor: Add ast2600 compatible string

Fan in Aspeed2600 has not been supported upstream but in Aspeed-SDK
only. The new method in dbus-sensors fansensor for getting fan type of a
hwmon path from compatible string does not include the ast2600-tach
string. This commit adds the string to the compatibleFanTypes list to
make the fans in mitchell search-able by the application.

Tested:
$ busctl tree xyz.openbmc_project.FanSensor
fan sensors are created successfully

Signed-off-by: Chau Ly <chaul@amperecomputing.com>
---
 src/FanMain.cpp | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/FanMain.cpp b/src/FanMain.cpp
index 9c8a738..cc8fcb4 100644
--- a/src/FanMain.cpp
+++ b/src/FanMain.cpp
@@ -66,6 +66,7 @@ std::optional<RedundancySensor> systemRedundancy;
 static const std::map<std::string, FanTypes> compatibleFanTypes = {
     {"aspeed,ast2400-pwm-tacho", FanTypes::aspeed},
     {"aspeed,ast2500-pwm-tacho", FanTypes::aspeed},
+    {"aspeed,ast2600-tach", FanTypes::aspeed},
     {"nuvoton,npcm750-pwm-fan", FanTypes::nuvoton},
     {"hpe,gxp-fan-ctrl", FanTypes::hpe}
     // add compatible string here for new fan type
-- 
2.34.1

